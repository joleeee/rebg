#![allow(non_camel_case_types, dead_code)]

use crate::arch::Arch;

macro_rules! enum_from_pairs {
    ($name:ident, $(($num:expr, $s:ident, $str:expr, $parent:ident)),*) => {
        #[derive(Clone, Copy, Debug, PartialEq)]
        pub enum $name {
            $( $s = $num, )*
        }

        impl $name {
            fn from_num(num: u16) -> Option<Self> {
                match num {
                    $( $num => Some($name::$s), )*
                    _ => None
                }
            }

            fn as_str(&self) -> &'static str {
                match self {
                    $( $name::$s => $str, )*
                }
            }

            fn canonical(&self) -> Self {
                match self {
                    $( $name::$s => $name::$parent, )*
                }
            }
        }
    };
}

enum_from_pairs!(
    Aarch64Reg,
    (1, Ffr, "ffr", Ffr),
    (2, Fp, "fp", Fp),
    (3, Lr, "lr", Lr),
    (4, Nzcv, "nzcv", Nzcv),
    (5, Sp, "sp", Sp),
    (6, Vg, "vg", Vg),
    (7, Wsp, "wsp", Wsp),
    (8, Wzr, "wzr", Wzr),
    (9, Xzr, "xzr", Xzr),
    (10, Za, "za", Za),
    (11, B0, "b0", B0),
    (12, B1, "b1", B1),
    (13, B2, "b2", B2),
    (14, B3, "b3", B3),
    (15, B4, "b4", B4),
    (16, B5, "b5", B5),
    (17, B6, "b6", B6),
    (18, B7, "b7", B7),
    (19, B8, "b8", B8),
    (20, B9, "b9", B9),
    (21, B10, "b10", B10),
    (22, B11, "b11", B11),
    (23, B12, "b12", B12),
    (24, B13, "b13", B13),
    (25, B14, "b14", B14),
    (26, B15, "b15", B15),
    (27, B16, "b16", B16),
    (28, B17, "b17", B17),
    (29, B18, "b18", B18),
    (30, B19, "b19", B19),
    (31, B20, "b20", B20),
    (32, B21, "b21", B21),
    (33, B22, "b22", B22),
    (34, B23, "b23", B23),
    (35, B24, "b24", B24),
    (36, B25, "b25", B25),
    (37, B26, "b26", B26),
    (38, B27, "b27", B27),
    (39, B28, "b28", B28),
    (40, B29, "b29", B29),
    (41, B30, "b30", B30),
    (42, B31, "b31", B31),
    (43, D0, "d0", D0),
    (44, D1, "d1", D1),
    (45, D2, "d2", D2),
    (46, D3, "d3", D3),
    (47, D4, "d4", D4),
    (48, D5, "d5", D5),
    (49, D6, "d6", D6),
    (50, D7, "d7", D7),
    (51, D8, "d8", D8),
    (52, D9, "d9", D9),
    (53, D10, "d10", D10),
    (54, D11, "d11", D11),
    (55, D12, "d12", D12),
    (56, D13, "d13", D13),
    (57, D14, "d14", D14),
    (58, D15, "d15", D15),
    (59, D16, "d16", D16),
    (60, D17, "d17", D17),
    (61, D18, "d18", D18),
    (62, D19, "d19", D19),
    (63, D20, "d20", D20),
    (64, D21, "d21", D21),
    (65, D22, "d22", D22),
    (66, D23, "d23", D23),
    (67, D24, "d24", D24),
    (68, D25, "d25", D25),
    (69, D26, "d26", D26),
    (70, D27, "d27", D27),
    (71, D28, "d28", D28),
    (72, D29, "d29", D29),
    (73, D30, "d30", D30),
    (74, D31, "d31", D31),
    (75, H0, "h0", H0),
    (76, H1, "h1", H1),
    (77, H2, "h2", H2),
    (78, H3, "h3", H3),
    (79, H4, "h4", H4),
    (80, H5, "h5", H5),
    (81, H6, "h6", H6),
    (82, H7, "h7", H7),
    (83, H8, "h8", H8),
    (84, H9, "h9", H9),
    (85, H10, "h10", H10),
    (86, H11, "h11", H11),
    (87, H12, "h12", H12),
    (88, H13, "h13", H13),
    (89, H14, "h14", H14),
    (90, H15, "h15", H15),
    (91, H16, "h16", H16),
    (92, H17, "h17", H17),
    (93, H18, "h18", H18),
    (94, H19, "h19", H19),
    (95, H20, "h20", H20),
    (96, H21, "h21", H21),
    (97, H22, "h22", H22),
    (98, H23, "h23", H23),
    (99, H24, "h24", H24),
    (100, H25, "h25", H25),
    (101, H26, "h26", H26),
    (102, H27, "h27", H27),
    (103, H28, "h28", H28),
    (104, H29, "h29", H29),
    (105, H30, "h30", H30),
    (106, H31, "h31", H31),
    (107, P0, "p0", P0),
    (108, P1, "p1", P1),
    (109, P2, "p2", P2),
    (110, P3, "p3", P3),
    (111, P4, "p4", P4),
    (112, P5, "p5", P5),
    (113, P6, "p6", P6),
    (114, P7, "p7", P7),
    (115, P8, "p8", P8),
    (116, P9, "p9", P9),
    (117, P10, "p10", P10),
    (118, P11, "p11", P11),
    (119, P12, "p12", P12),
    (120, P13, "p13", P13),
    (121, P14, "p14", P14),
    (122, P15, "p15", P15),
    (123, Q0, "q0", Q0),
    (124, Q1, "q1", Q1),
    (125, Q2, "q2", Q2),
    (126, Q3, "q3", Q3),
    (127, Q4, "q4", Q4),
    (128, Q5, "q5", Q5),
    (129, Q6, "q6", Q6),
    (130, Q7, "q7", Q7),
    (131, Q8, "q8", Q8),
    (132, Q9, "q9", Q9),
    (133, Q10, "q10", Q10),
    (134, Q11, "q11", Q11),
    (135, Q12, "q12", Q12),
    (136, Q13, "q13", Q13),
    (137, Q14, "q14", Q14),
    (138, Q15, "q15", Q15),
    (139, Q16, "q16", Q16),
    (140, Q17, "q17", Q17),
    (141, Q18, "q18", Q18),
    (142, Q19, "q19", Q19),
    (143, Q20, "q20", Q20),
    (144, Q21, "q21", Q21),
    (145, Q22, "q22", Q22),
    (146, Q23, "q23", Q23),
    (147, Q24, "q24", Q24),
    (148, Q25, "q25", Q25),
    (149, Q26, "q26", Q26),
    (150, Q27, "q27", Q27),
    (151, Q28, "q28", Q28),
    (152, Q29, "q29", Q29),
    (153, Q30, "q30", Q30),
    (154, Q31, "q31", Q31),
    (155, S0, "s0", S0),
    (156, S1, "s1", S1),
    (157, S2, "s2", S2),
    (158, S3, "s3", S3),
    (159, S4, "s4", S4),
    (160, S5, "s5", S5),
    (161, S6, "s6", S6),
    (162, S7, "s7", S7),
    (163, S8, "s8", S8),
    (164, S9, "s9", S9),
    (165, S10, "s10", S10),
    (166, S11, "s11", S11),
    (167, S12, "s12", S12),
    (168, S13, "s13", S13),
    (169, S14, "s14", S14),
    (170, S15, "s15", S15),
    (171, S16, "s16", S16),
    (172, S17, "s17", S17),
    (173, S18, "s18", S18),
    (174, S19, "s19", S19),
    (175, S20, "s20", S20),
    (176, S21, "s21", S21),
    (177, S22, "s22", S22),
    (178, S23, "s23", S23),
    (179, S24, "s24", S24),
    (180, S25, "s25", S25),
    (181, S26, "s26", S26),
    (182, S27, "s27", S27),
    (183, S28, "s28", S28),
    (184, S29, "s29", S29),
    (185, S30, "s30", S30),
    (186, S31, "s31", S31),
    (187, W0, "w0", X0),
    (188, W1, "w1", X1),
    (189, W2, "w2", X2),
    (190, W3, "w3", X3),
    (191, W4, "w4", X4),
    (192, W5, "w5", X5),
    (193, W6, "w6", X6),
    (194, W7, "w7", X7),
    (195, W8, "w8", X8),
    (196, W9, "w9", X9),
    (197, W10, "w10", X10),
    (198, W11, "w11", X11),
    (199, W12, "w12", X12),
    (200, W13, "w13", X13),
    (201, W14, "w14", X14),
    (202, W15, "w15", X15),
    (203, W16, "w16", X16),
    (204, W17, "w17", X17),
    (205, W18, "w18", X18),
    (206, W19, "w19", X19),
    (207, W20, "w20", X20),
    (208, W21, "w21", X21),
    (209, W22, "w22", X22),
    (210, W23, "w23", X23),
    (211, W24, "w24", X24),
    (212, W25, "w25", X25),
    (213, W26, "w26", X26),
    (214, W27, "w27", X27),
    (215, W28, "w28", X28),
    (216, W29, "w29", Fp), // i think these two make sense :)
    (217, W30, "w30", Lr),
    (218, X0, "x0", X0),
    (219, X1, "x1", X1),
    (220, X2, "x2", X2),
    (221, X3, "x3", X3),
    (222, X4, "x4", X4),
    (223, X5, "x5", X5),
    (224, X6, "x6", X6),
    (225, X7, "x7", X7),
    (226, X8, "x8", X8),
    (227, X9, "x9", X9),
    (228, X10, "x10", X10),
    (229, X11, "x11", X11),
    (230, X12, "x12", X12),
    (231, X13, "x13", X13),
    (232, X14, "x14", X14),
    (233, X15, "x15", X15),
    (234, X16, "x16", X16),
    (235, X17, "x17", X17),
    (236, X18, "x18", X18),
    (237, X19, "x19", X19),
    (238, X20, "x20", X20),
    (239, X21, "x21", X21),
    (240, X22, "x22", X22),
    (241, X23, "x23", X23),
    (242, X24, "x24", X24),
    (243, X25, "x25", X25),
    (244, X26, "x26", X26),
    (245, X27, "x27", X27),
    (246, X28, "x28", X28),
    (247, Z0, "z0", Z0),
    (248, Z1, "z1", Z1),
    (249, Z2, "z2", Z2),
    (250, Z3, "z3", Z3),
    (251, Z4, "z4", Z4),
    (252, Z5, "z5", Z5),
    (253, Z6, "z6", Z6),
    (254, Z7, "z7", Z7),
    (255, Z8, "z8", Z8),
    (256, Z9, "z9", Z9),
    (257, Z10, "z10", Z10),
    (258, Z11, "z11", Z11),
    (259, Z12, "z12", Z12),
    (260, Z13, "z13", Z13),
    (261, Z14, "z14", Z14),
    (262, Z15, "z15", Z15),
    (263, Z16, "z16", Z16),
    (264, Z17, "z17", Z17),
    (265, Z18, "z18", Z18),
    (266, Z19, "z19", Z19),
    (267, Z20, "z20", Z20),
    (268, Z21, "z21", Z21),
    (269, Z22, "z22", Z22),
    (270, Z23, "z23", Z23),
    (271, Z24, "z24", Z24),
    (272, Z25, "z25", Z25),
    (273, Z26, "z26", Z26),
    (274, Z27, "z27", Z27),
    (275, Z28, "z28", Z28),
    (276, Z29, "z29", Z29),
    (277, Z30, "z30", Z30),
    (278, Z31, "z31", Z31),
    (279, Zab0, "zab0", Zab0),
    (280, Zad0, "zad0", Zad0),
    (281, Zad1, "zad1", Zad1),
    (282, Zad2, "zad2", Zad2),
    (283, Zad3, "zad3", Zad3),
    (284, Zad4, "zad4", Zad4),
    (285, Zad5, "zad5", Zad5),
    (286, Zad6, "zad6", Zad6),
    (287, Zad7, "zad7", Zad7),
    (288, Zah0, "zah0", Zah0),
    (289, Zah1, "zah1", Zah1),
    (290, Zaq0, "zaq0", Zaq0),
    (291, Zaq1, "zaq1", Zaq1),
    (292, Zaq2, "zaq2", Zaq2),
    (293, Zaq3, "zaq3", Zaq3),
    (294, Zaq4, "zaq4", Zaq4),
    (295, Zaq5, "zaq5", Zaq5),
    (296, Zaq6, "zaq6", Zaq6),
    (297, Zaq7, "zaq7", Zaq7),
    (298, Zaq8, "zaq8", Zaq8),
    (299, Zaq9, "zaq9", Zaq9),
    (300, Zaq10, "zaq10", Zaq10),
    (301, Zaq11, "zaq11", Zaq11),
    (302, Zaq12, "zaq12", Zaq12),
    (303, Zaq13, "zaq13", Zaq13),
    (304, Zaq14, "zaq14", Zaq14),
    (305, Zaq15, "zaq15", Zaq15),
    (306, Zas0, "zas0", Zas0),
    (307, Zas1, "zas1", Zas1),
    (308, Zas2, "zas2", Zas2),
    (309, Zas3, "zas3", Zas3),
    (310, V0, "v0", V0),
    (311, V1, "v1", V1),
    (312, V2, "v2", V2),
    (313, V3, "v3", V3),
    (314, V4, "v4", V4),
    (315, V5, "v5", V5),
    (316, V6, "v6", V6),
    (317, V7, "v7", V7),
    (318, V8, "v8", V8),
    (319, V9, "v9", V9),
    (320, V10, "v10", V10),
    (321, V11, "v11", V11),
    (322, V12, "v12", V12),
    (323, V13, "v13", V13),
    (324, V14, "v14", V14),
    (325, V15, "v15", V15),
    (326, V16, "v16", V16),
    (327, V17, "v17", V17),
    (328, V18, "v18", V18),
    (329, V19, "v19", V19),
    (330, V20, "v20", V20),
    (331, V21, "v21", V21),
    (332, V22, "v22", V22),
    (333, V23, "v23", V23),
    (334, V24, "v24", V24),
    (335, V25, "v25", V25),
    (336, V26, "v26", V26),
    (337, V27, "v27", V27),
    (338, V28, "v28", V28),
    (339, V29, "v29", V29),
    (340, V30, "v30", V30),
    (341, V31, "v31", V31)
);

enum_from_pairs!(
    X64Reg,
    (1, Ah, "ah", Rax),
    (2, Al, "al", Rax),
    (3, Ax, "ax", Rax),
    (4, Bh, "bh", Rbx),
    (5, Bl, "bl", Rbx),
    (6, Bp, "bp", Rbp),
    (7, Bpl, "bpl", Rbp),
    (8, Bx, "bx", Rbx),
    (9, Ch, "ch", Rcx),
    (10, Cl, "cl", Rcx),
    (11, Cs, "cs", Cs),
    (12, Cx, "cx", Rcx),
    (13, Dh, "dh", Rdx),
    (14, Di, "di", Rdi),
    (15, Dil, "dil", Rdi),
    (16, Dl, "dl", Rdx),
    (17, Ds, "ds", Ds),
    (18, Dx, "dx", Rdx),
    (19, Eax, "eax", Rax),
    (20, Ebp, "ebp", Rbp),
    (21, Ebx, "ebx", Rbx),
    (22, Ecx, "ecx", Rcx),
    (23, Edi, "edi", Rdi),
    (24, Edx, "edx", Rdx),
    (25, Rflags, "rflags", Rflags),
    (26, Eip, "eip", Rip),
    (27, Eiz, "eiz", Eiz), // Riz?
    (28, Es, "es", Es),
    (29, Esi, "esi", Rsi),
    (30, Esp, "esp", Rsp),
    (31, Fpsw, "fpsw", Fpsw),
    (32, Fs, "fs", Fs),
    (33, Gs, "gs", Gs),
    (34, Ip, "ip", Ip),
    (35, Rax, "rax", Rax),
    (36, Rbp, "rbp", Rbp),
    (37, Rbx, "rbx", Rbx),
    (38, Rcx, "rcx", Rcx),
    (39, Rdi, "rdi", Rdi),
    (40, Rdx, "rdx", Rdx),
    (41, Rip, "rip", Rip),
    (42, Riz, "riz", Riz),
    (43, Rsi, "rsi", Rsi),
    (44, Rsp, "rsp", Rsp),
    (45, Si, "si", Rsi),
    (46, Sil, "sil", Rsi),
    (47, Sp, "sp", Rsp),
    (48, Spl, "spl", Rsp),
    (49, Ss, "ss", Ss),
    (50, Cr0, "cr0", Cr0),
    (51, Cr1, "cr1", Cr1),
    (52, Cr2, "cr2", Cr2),
    (53, Cr3, "cr3", Cr3),
    (54, Cr4, "cr4", Cr4),
    (55, Cr5, "cr5", Cr5),
    (56, Cr6, "cr6", Cr6),
    (57, Cr7, "cr7", Cr7),
    (58, Cr8, "cr8", Cr8),
    (59, Cr9, "cr9", Cr9),
    (60, Cr10, "cr10", Cr10),
    (61, Cr11, "cr11", Cr11),
    (62, Cr12, "cr12", Cr12),
    (63, Cr13, "cr13", Cr13),
    (64, Cr14, "cr14", Cr14),
    (65, Cr15, "cr15", Cr15),
    (66, Dr0, "dr0", Dr0),
    (67, Dr1, "dr1", Dr1),
    (68, Dr2, "dr2", Dr2),
    (69, Dr3, "dr3", Dr3),
    (70, Dr4, "dr4", Dr4),
    (71, Dr5, "dr5", Dr5),
    (72, Dr6, "dr6", Dr6),
    (73, Dr7, "dr7", Dr7),
    (74, Dr8, "dr8", Dr8),
    (75, Dr9, "dr9", Dr9),
    (76, Dr10, "dr10", Dr10),
    (77, Dr11, "dr11", Dr11),
    (78, Dr12, "dr12", Dr12),
    (79, Dr13, "dr13", Dr13),
    (80, Dr14, "dr14", Dr14),
    (81, Dr15, "dr15", Dr15),
    (82, Fp0, "fp0", Fp0),
    (83, Fp1, "fp1", Fp1),
    (84, Fp2, "fp2", Fp2),
    (85, Fp3, "fp3", Fp3),
    (86, Fp4, "fp4", Fp4),
    (87, Fp5, "fp5", Fp5),
    (88, Fp6, "fp6", Fp6),
    (89, Fp7, "fp7", Fp7),
    (90, K0, "k0", K0),
    (91, K1, "k1", K1),
    (92, K2, "k2", K2),
    (93, K3, "k3", K3),
    (94, K4, "k4", K4),
    (95, K5, "k5", K5),
    (96, K6, "k6", K6),
    (97, K7, "k7", K7),
    (98, Mm0, "mm0", Mm0),
    (99, Mm1, "mm1", Mm1),
    (100, Mm2, "mm2", Mm2),
    (101, Mm3, "mm3", Mm3),
    (102, Mm4, "mm4", Mm4),
    (103, Mm5, "mm5", Mm5),
    (104, Mm6, "mm6", Mm6),
    (105, Mm7, "mm7", Mm7),
    (106, R8, "r8", R8),
    (107, R9, "r9", R9),
    (108, R10, "r10", R10),
    (109, R11, "r11", R11),
    (110, R12, "r12", R12),
    (111, R13, "r13", R13),
    (112, R14, "r14", R14),
    (113, R15, "r15", R15),
    (114, St0, "st(0)", St0),
    (115, St1, "st(1)", St1),
    (116, St2, "st(2)", St2),
    (117, St3, "st(3)", St3),
    (118, St4, "st(4)", St4),
    (119, St5, "st(5)", St5),
    (120, St6, "st(6)", St6),
    (121, St7, "st(7)", St7),
    (122, Xmm0, "xmm0", Xmm0),
    (123, Xmm1, "xmm1", Xmm1),
    (124, Xmm2, "xmm2", Xmm2),
    (125, Xmm3, "xmm3", Xmm3),
    (126, Xmm4, "xmm4", Xmm4),
    (127, Xmm5, "xmm5", Xmm5),
    (128, Xmm6, "xmm6", Xmm6),
    (129, Xmm7, "xmm7", Xmm7),
    (130, Xmm8, "xmm8", Xmm8),
    (131, Xmm9, "xmm9", Xmm9),
    (132, Xmm10, "xmm10", Xmm10),
    (133, Xmm11, "xmm11", Xmm11),
    (134, Xmm12, "xmm12", Xmm12),
    (135, Xmm13, "xmm13", Xmm13),
    (136, Xmm14, "xmm14", Xmm14),
    (137, Xmm15, "xmm15", Xmm15),
    (138, Xmm16, "xmm16", Xmm16),
    (139, Xmm17, "xmm17", Xmm17),
    (140, Xmm18, "xmm18", Xmm18),
    (141, Xmm19, "xmm19", Xmm19),
    (142, Xmm20, "xmm20", Xmm20),
    (143, Xmm21, "xmm21", Xmm21),
    (144, Xmm22, "xmm22", Xmm22),
    (145, Xmm23, "xmm23", Xmm23),
    (146, Xmm24, "xmm24", Xmm24),
    (147, Xmm25, "xmm25", Xmm25),
    (148, Xmm26, "xmm26", Xmm26),
    (149, Xmm27, "xmm27", Xmm27),
    (150, Xmm28, "xmm28", Xmm28),
    (151, Xmm29, "xmm29", Xmm29),
    (152, Xmm30, "xmm30", Xmm30),
    (153, Xmm31, "xmm31", Xmm31),
    (154, Ymm0, "ymm0", Ymm0),
    (155, Ymm1, "ymm1", Ymm1),
    (156, Ymm2, "ymm2", Ymm2),
    (157, Ymm3, "ymm3", Ymm3),
    (158, Ymm4, "ymm4", Ymm4),
    (159, Ymm5, "ymm5", Ymm5),
    (160, Ymm6, "ymm6", Ymm6),
    (161, Ymm7, "ymm7", Ymm7),
    (162, Ymm8, "ymm8", Ymm8),
    (163, Ymm9, "ymm9", Ymm9),
    (164, Ymm10, "ymm10", Ymm10),
    (165, Ymm11, "ymm11", Ymm11),
    (166, Ymm12, "ymm12", Ymm12),
    (167, Ymm13, "ymm13", Ymm13),
    (168, Ymm14, "ymm14", Ymm14),
    (169, Ymm15, "ymm15", Ymm15),
    (170, Ymm16, "ymm16", Ymm16),
    (171, Ymm17, "ymm17", Ymm17),
    (172, Ymm18, "ymm18", Ymm18),
    (173, Ymm19, "ymm19", Ymm19),
    (174, Ymm20, "ymm20", Ymm20),
    (175, Ymm21, "ymm21", Ymm21),
    (176, Ymm22, "ymm22", Ymm22),
    (177, Ymm23, "ymm23", Ymm23),
    (178, Ymm24, "ymm24", Ymm24),
    (179, Ymm25, "ymm25", Ymm25),
    (180, Ymm26, "ymm26", Ymm26),
    (181, Ymm27, "ymm27", Ymm27),
    (182, Ymm28, "ymm28", Ymm28),
    (183, Ymm29, "ymm29", Ymm29),
    (184, Ymm30, "ymm30", Ymm30),
    (185, Ymm31, "ymm31", Ymm31),
    (186, Zmm0, "zmm0", Zmm0),
    (187, Zmm1, "zmm1", Zmm1),
    (188, Zmm2, "zmm2", Zmm2),
    (189, Zmm3, "zmm3", Zmm3),
    (190, Zmm4, "zmm4", Zmm4),
    (191, Zmm5, "zmm5", Zmm5),
    (192, Zmm6, "zmm6", Zmm6),
    (193, Zmm7, "zmm7", Zmm7),
    (194, Zmm8, "zmm8", Zmm8),
    (195, Zmm9, "zmm9", Zmm9),
    (196, Zmm10, "zmm10", Zmm10),
    (197, Zmm11, "zmm11", Zmm11),
    (198, Zmm12, "zmm12", Zmm12),
    (199, Zmm13, "zmm13", Zmm13),
    (200, Zmm14, "zmm14", Zmm14),
    (201, Zmm15, "zmm15", Zmm15),
    (202, Zmm16, "zmm16", Zmm16),
    (203, Zmm17, "zmm17", Zmm17),
    (204, Zmm18, "zmm18", Zmm18),
    (205, Zmm19, "zmm19", Zmm19),
    (206, Zmm20, "zmm20", Zmm20),
    (207, Zmm21, "zmm21", Zmm21),
    (208, Zmm22, "zmm22", Zmm22),
    (209, Zmm23, "zmm23", Zmm23),
    (210, Zmm24, "zmm24", Zmm24),
    (211, Zmm25, "zmm25", Zmm25),
    (212, Zmm26, "zmm26", Zmm26),
    (213, Zmm27, "zmm27", Zmm27),
    (214, Zmm28, "zmm28", Zmm28),
    (215, Zmm29, "zmm29", Zmm29),
    (216, Zmm30, "zmm30", Zmm30),
    (217, Zmm31, "zmm31", Zmm31),
    (218, R8B, "r8b", R8),
    (219, R9B, "r9b", R9),
    (220, R10B, "r10b", R10),
    (221, R11B, "r11b", R11),
    (222, R12B, "r12b", R12),
    (223, R13B, "r13b", R13),
    (224, R14B, "r14b", R14),
    (225, R15B, "r15b", R15),
    (226, R8D, "r8d", R8),
    (227, R9D, "r9d", R9),
    (228, R10D, "r10d", R10),
    (229, R11D, "r11d", R11),
    (230, R12D, "r12d", R12),
    (231, R13D, "r13d", R13),
    (232, R14D, "r14d", R14),
    (233, R15D, "r15d", R15),
    (234, R8W, "r8w", R8),
    (235, R9W, "r9w", R9),
    (236, R10W, "r10w", R10),
    (237, R11W, "r11w", R11),
    (238, R12W, "r12w", R12),
    (239, R13W, "r13w", R13),
    (240, R14W, "r14w", R14),
    (241, R15W, "r15w", R15),
    (242, Bnd0, "bnd0", Bnd0),
    (243, Bnd1, "bnd1", Bnd1),
    (244, Bnd2, "bnd2", Bnd2),
    (245, Bnd3, "bnd3", Bnd3)
);

#[derive(Clone, Copy, Debug)]
pub enum Reg {
    Aarch64Reg(Aarch64Reg),
    X64Reg(X64Reg),
}

impl Reg {
    pub fn from_num(arch: Arch, num: u16) -> Option<Self> {
        Some(match arch {
            Arch::ARM64 => Reg::Aarch64Reg(Aarch64Reg::from_num(num)?),
            Arch::X86_64 => Reg::X64Reg(X64Reg::from_num(num)?),
        })
    }

    pub fn canonical(self) -> Self {
        match self {
            Reg::Aarch64Reg(r) => Reg::Aarch64Reg(r.canonical()),
            Reg::X64Reg(r) => Reg::X64Reg(r.canonical()),
        }
    }

    pub fn as_str(&self) -> &'static str {
        match self {
            Reg::Aarch64Reg(r) => r.as_str(),
            Reg::X64Reg(r) => r.as_str(),
        }
    }
}

#[cfg(test)]
mod tests {
    use capstone::RegId;
    #[allow(unused_imports)]
    use convert_case::Casing;

    use super::{Aarch64Reg, X64Reg};
    use crate::arch::Arch;

    #[test]
    fn aarch64_canon() {
        assert_eq!(Aarch64Reg::W0.canonical(), Aarch64Reg::X0);
        assert_eq!(Aarch64Reg::X5.canonical(), Aarch64Reg::X5);
        assert_eq!(Aarch64Reg::Sp.canonical(), Aarch64Reg::Sp);
        assert_eq!(Aarch64Reg::Xzr.canonical(), Aarch64Reg::Xzr);
        assert_eq!(Aarch64Reg::Lr.canonical(), Aarch64Reg::Lr);
        assert_eq!(Aarch64Reg::W30.canonical(), Aarch64Reg::Lr);
    }

    #[test]
    fn aarch64_reg_names() {
        let arch = Arch::ARM64;
        let cs = arch.make_capstone().unwrap();

        for i in 0..=u16::MAX {
            let i = RegId(i);

            let cs_name = cs.reg_name(i);
            let our_name = Aarch64Reg::from_num(i.0).map(|reg| reg.as_str().to_string());

            if cs_name != our_name {
                panic!("{cs_name:?} != {our_name:?}")
            }

            // cargo test aarch64_reg_names -- --nocapture
            // if let Some(name) = cs_name {
            //     println!(
            //         "({}, {}, \"{}\", {}),",
            //         i.0,
            //         name.to_case(convert_case::Case::Pascal),
            //         name,
            //         name.to_case(convert_case::Case::Pascal),
            //     );
            // }
        }
    }

    #[test]
    fn x64_reg_names() {
        let arch = Arch::X86_64;
        let cs = arch.make_capstone().unwrap();

        for i in 0..=u16::MAX {
            let i = RegId(i);

            let cs_name = cs.reg_name(i);
            let our_name = X64Reg::from_num(i.0).map(|reg| reg.as_str().to_string());

            if cs_name != our_name {
                panic!("{cs_name:?} != {our_name:?}")
            }

            // if let Some(name) = cs_name {
            //     println!(
            //         "({}, {}, \"{}\", {}),",
            //         i.0,
            //         name.to_case(convert_case::Case::Pascal),
            //         name,
            //         name.to_case(convert_case::Case::Pascal),
            //     );
            // }
        }
    }
}
